<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Is mapStateToProps causing needless re-renders?</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Is mapStateToProps causing needless re-renders?</h1>
</header>
<section data-field="subtitle" class="p-summary">
If you are a React developer working on a less than trivial project, you are likely using Redux for state management. In a crude nutshellâ€¦
</section>
<section data-field="body" class="e-content">
<section name="7e69" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="ae15" id="ae15" class="graf graf--h3 graf--leading graf--title">Is mapStateToProps causing needless re-renders?</h3><figure name="16d6" id="16d6" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*8hQKZ70wmQKEM2Jr1NZpYQ.jpeg" data-width="1072" data-height="752" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*8hQKZ70wmQKEM2Jr1NZpYQ.jpeg"><figcaption class="imageCaption">Pictured: simple redux flow between connected components ðŸ˜«</figcaption></figure><p name="a7fd" id="a7fd" class="graf graf--p graf-after--figure">If you are a React developer working on a less than trivial project, you are likely using Redux for state management. In a crude nutshell, your connected components are all listening for any updates to the <code class="markup--code markup--p-code">store</code>, the global state of the app, and your <code class="markup--code markup--p-code">mapStateToProps</code> function takes some slice of this state and returns it as props to your connected component.</p><p name="767e" id="767e" class="graf graf--p graf-after--p">I was recently working on a strange bug at work involving a redux-connected component: a user would hover over a slice of our pie chart component and sometimes the label in the center of the pie would just revert back to the default labelâ€¦ hmmm. For some reason, our pie chart was re-rendering even though itâ€™s state had not updated. Double hmmmâ€¦</p><figure name="1410" id="1410" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*8FNqmQdm_bey9FJk7tmFSQ.gif" data-width="498" data-height="460" src="https://cdn-images-1.medium.com/max/800/1*8FNqmQdm_bey9FJk7tmFSQ.gif"></figure><p name="dc24" id="dc24" class="graf graf--p graf-after--figure">This intermittent bug was difficult to reproduce, but once it was sharing the store with a widget consuming realtime socket updates, I noticed it happened each time our store received a realtime update.</p><p name="f044" id="f044" class="graf graf--p graf-after--p">Should a component re-render each time the store receives an updateâ€Šâ€”â€Ševen if itâ€™s not interested in that particular slice of the state? Nah, that canâ€™t be right. Then how does our <code class="markup--code markup--p-code">mapStateToProps</code> function understand when it should trigger a re-render? Well, under the hood, redux does a shallow comparison of the state returned from <code class="markup--code markup--p-code">mapStateToProps</code> by implementing the <code class="markup--code markup--p-code">shouldComponentUpdate</code> method. Interesting. Still doesnâ€™t quite explain why our pie is freaking out though.</p><p name="aca3" id="aca3" class="graf graf--p graf-after--p">Hereâ€™s a simplified version of our pie chart code:</p><pre name="677d" id="677d" class="graf graf--pre graf-after--p">import React from &#39;react&#39;;<br>import { connect } from &#39;react-redux&#39;;<br><br>import PieChartWidget from &#39;./components/PieChartWidget&#39;;<br><br>const mergeProps = (stateProps, dispatchProps, ownProps) =&gt; {<br>  return {...ownProps, ...dispatchProps, ...stateProps};<br>};<br><br>const mapStateToProps = (state, ownProps) =&gt; {<br>  const data = state.widgetData;<br>  const apiArgs = { ...ownProps.apiArgs }; //OOPS!!!!</pre><pre name="bdcf" id="bdcf" class="graf graf--pre graf-after--pre">  return {<br>    data,<br>    apiArgs<br>  };<br>};<br><br>const IssuesPieChart = ({<br>  apiArgs,<br>  data,<br>}) =&gt; (<br>  &lt;DataLoader<br>    apiArgs={apiArgs}<br>    {...others}<br>  &gt;<br>    &lt;PieChartWidget<br>      data={data}<br>    /&gt;<br>  &lt;/Widget&gt;<br>);<br><br>export default connect(mapStateToProps, mapWidgetDispatchToProps, mergeProps)(IssuesPieChart);</pre><p name="760b" id="760b" class="graf graf--p graf-after--pre">Well, it turns out we were making an honest mistake in our <code class="markup--code markup--p-code">mapStateToProps</code> function, which was copying state using the spreadÂ <code class="markup--code markup--p-code">...</code> operator. Dâ€™oh. Common array operations like <code class="markup--code markup--p-code">slice, concat, filter</code> orÂ <code class="markup--code markup--p-code">...</code> create a new reference to an object or array which will trigger a component update when redux internally compares the old and new state.</p><p name="ae9c" id="ae9c" class="graf graf--p graf-after--p">The quick fix here was to simply assign our state like this:</p><pre name="069a" id="069a" class="graf graf--pre graf-after--p">const mapStateToProps = (state, ownProps) =&gt; {<br>  const data = state.widgetData;<br>  const apiArgs = ownProps.apiArgs;</pre><pre name="983d" id="983d" class="graf graf--pre graf-after--pre"> return {<br>    data,<br>    apiArgs<br>  };<br>};</pre><p name="6f3f" id="6f3f" class="graf graf--p graf-after--pre">If your use case is more complicated and there is some filtering or selecting of a part of the state tree you care about, you may want to check out memoized selector functions to prevent expensive comparisons and needless re-renders: <a href="https://redux.js.org/recipes/computing-derived-data#creating-a-memoized-selector" data-href="https://redux.js.org/recipes/computing-derived-data#creating-a-memoized-selector" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://redux.js.org/recipes/computing-derived-data#creating-a-memoized-selector</a></p><h4 name="21ae" id="21ae" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">JavaScript In PlainÂ English</strong></h4><p name="87c6" id="87c6" class="graf graf--p graf-after--h4 graf--trailing">Enjoyed this article? If so, get more similar content by <a href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" data-href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">subscribing to our YouTube channel</strong></a><strong class="markup--strong markup--p-strong">!</strong></p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@brianjenney" class="p-author h-card">Brian Jenney</a> on <a href="https://medium.com/p/6d14346b3cb8"><time class="dt-published" datetime="2020-06-06T22:00:52.083Z">June 6, 2020</time></a>.</p><p><a href="https://medium.com/@brianjenney/is-mapstatetoprops-causing-needless-re-renders-6d14346b3cb8" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 30, 2025.</p></footer></article></body></html>