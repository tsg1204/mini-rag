<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Using Jest to Enforce Testing Thresholds and Test Whatâ€™s Really Important</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Using Jest to Enforce Testing Thresholds and Test Whatâ€™s Really Important</h1>
</header>
<section data-field="subtitle" class="p-summary">
Whether youâ€™re using TDD or whatever itâ€™s called when you write tests after your code (DDT?), there is no silver bullet for creating goodâ€¦
</section>
<section data-field="body" class="e-content">
<section name="7c92" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="2bba" id="2bba" class="graf graf--h3 graf--leading graf--title">Using Jest to Enforce Testing Thresholds and Test Whatâ€™s Really Important</h3><figure name="51d1" id="51d1" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*ZwpRkMyKus1JZAwnm95Zmw.jpeg" data-width="626" data-height="417" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*ZwpRkMyKus1JZAwnm95Zmw.jpeg"><figcaption class="imageCaption">I couldâ€™ve sworn I testedÂ that!</figcaption></figure><p name="c34b" id="c34b" class="graf graf--p graf-after--figure">Whether youâ€™re using TDD or whatever itâ€™s called when you write tests after your code (DDT?), there is no silver bullet for creating good unit tests. What separates bad unit tests from useful ones you might ask? Good unit tests explore possibilities and decision points that arenâ€™t easily reproducible while poorly written tests provide a false sense of security by testing happy paths and trivial scenarios.</p><p name="bab0" id="bab0" class="graf graf--p graf-after--p">Youâ€™ve just finished a feature and written some tests. A reviewer then looks over your code and accompanying tests and is pleased. The code is released that Friday around 5pm (natch ðŸ˜‰), resulting in a symphony of PagerDuty alerts emanating from your phone. Oh no! Who wouldâ€™ve thought a user would mis-spell an email, you curse at your mobile device.</p><p name="834f" id="834f" class="graf graf--p graf-after--p">Simply writing tests isnâ€™t enough. In order to make sure the code we write covers edge cases, our team uses a coverage collection tool provided by jest with testing thresholds to instill more confidence in what we ship.</p><p name="87a0" id="87a0" class="graf graf--p graf-after--p">Cloroxâ€™s fullstack team uses ReactJS for our e-commerce sites along with testing-library and jest for unit tests. We began the exercise of including tests in our workflow recently but we soon realized that tests were often the first sacrifice when we were short on time. We needed a way to make sure our code coverage did not drop below itâ€™s previous threshold. Luckily jest offers a way to keep test coverage at a base level which ensures that when new code is written, new tests must also be written to keep us at our base level or above.</p><p name="1f44" id="1f44" class="graf graf--p graf-after--p">Setting up thresholds in an npm project is simple. At the root of your package.json fileâ€Šâ€”â€Šadd the following configuration:</p><pre name="83e2" id="83e2" class="graf graf--pre graf-after--p">&quot;jest&quot;: {<br>  &quot;coverageThreshold&quot;: {<br>    &quot;global&quot;: {<br>      &quot;branches&quot;: 99,<br>      &quot;functions&quot;: 90,<br>      &quot;lines&quot;: 80,<br>      &quot;statements&quot;: 80<br>     }<br>   }<br>}</pre><p name="9387" id="9387" class="graf graf--p graf-after--pre">To collect code coverage via script command:</p><pre name="623f" id="623f" class="graf graf--pre graf-after--p">&quot;scripts&quot;: {<br>  &quot;test&quot;: &quot;jest&quot;,<br>  &quot;test:coverage&quot;: &quot;jest --collectCoverage&quot;  <br>  &quot;start&quot;: &quot;NODE_ENV=development npx webpack --progress --color --watch&quot;,<br><br>}</pre><p name="cfc8" id="cfc8" class="graf graf--p graf-after--pre">Our global threshold makes sure that out of all lines of code in our codebase, we explore 99% of branches (decision points like if/else statements), 90% of functions, 80% of lines and 80% of executable statements.</p><p name="54a5" id="54a5" class="graf graf--p graf-after--p">Now that you have jest installed along with the scripts above in your package.json file, executing <code class="markup--code markup--p-code">npm run test:coverage</code> in your projectâ€™s terminal will produce a table that looks like this:</p><figure name="8260" id="8260" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*D-GqaGcarTLCVtVwfRAJvA.png" data-width="1716" data-height="452" src="https://cdn-images-1.medium.com/max/800/1*D-GqaGcarTLCVtVwfRAJvA.png"></figure><p name="e803" id="e803" class="graf graf--p graf-after--figure">This print-out can be useful for identifying sections of code that need attention but if you are working on a specific feature/component, the html file <code class="markup--code markup--p-code">&lt;your_project&gt;/coverage/lcov-report/index.html</code> generated from running this command is useful for a more granular view of coverage:</p><figure name="cff0" id="cff0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*YFr33KrAJ8SQPfxTE-awUA.png" data-width="1696" data-height="1732" src="https://cdn-images-1.medium.com/max/800/1*YFr33KrAJ8SQPfxTE-awUA.png"></figure><p name="8d14" id="8d14" class="graf graf--p graf-after--figure">In this view we see <code class="markup--code markup--p-code">Nx</code> tells us the number of times this code was executed as part of the test suite.</p><p name="dc98" id="dc98" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">I</code> lets us know that we have not explored the <code class="markup--code markup--p-code">if</code> path while <code class="markup--code markup--p-code">E</code> alerts to us to an untested <code class="markup--code markup--p-code">else</code> path.</p><p name="0888" id="0888" class="graf graf--p graf-after--p">A red highlight signals an untested statement of code and a yellow highlight signals an untested statement in a branch.</p><p name="a612" id="a612" class="graf graf--p graf-after--p">Armed with this information we can go back and write more comprehensive tests that reach these decision points.</p><p name="106d" id="106d" class="graf graf--p graf-after--p graf--trailing">Sometimes it can feel like tests are a chore to write and as a result, they can suffer in quality and effectiveness. When written well, they offer developers a higher sense of confidence in what they ship and can surface unexpected scenarios and decision paths not easily reproducible in the user interface. Happy testing!</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@brianjenney" class="p-author h-card">Brian Jenney</a> on <a href="https://medium.com/p/9cb3435a1ee0"><time class="dt-published" datetime="2021-07-13T15:24:59.130Z">July 13, 2021</time></a>.</p><p><a href="https://medium.com/@brianjenney/using-jest-to-enforce-testing-thresholds-and-test-whats-really-important-9cb3435a1ee0" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 30, 2025.</p></footer></article></body></html>